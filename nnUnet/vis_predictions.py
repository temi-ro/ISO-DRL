# File entirely generated by Google Gemini 3 (For more info, see report Section 7.1)

# This script visualizes the predictions of the nnU-Net model
# on a specific slice of a 3D MRI volume.

import nibabel as nib
import matplotlib.pyplot as plt
import numpy as np

def visualize_prediction(img_path, gt_path, pred_path, slice_idx=0):
    # Load the NIfTI files
    img = nib.load(img_path).get_fdata()
    gt = nib.load(gt_path).get_fdata()
    pred = nib.load(pred_path).get_fdata()

    # Create the figure
    fig, axes = plt.subplots(1, 3, figsize=(15, 5))
    
    # 1. Original Image
    axes[0].imshow(img[:, :, slice_idx].T, cmap='gray', origin='lower')
    axes[0].set_title("Input MRI Image")
    axes[0].axis('off')

    # 2. Ground Truth Overlay
    axes[1].imshow(img[:, :, slice_idx].T, cmap='gray', origin='lower')
    axes[1].imshow(gt[:, :, slice_idx].T, cmap='gray', alpha=0.5, origin='lower')
    axes[1].set_title("Ground Truth")
    axes[1].axis('off')

    # 3. Prediction Overlay
    axes[2].imshow(img[:, :, slice_idx].T, cmap='gray', origin='lower')
    axes[2].imshow(pred[:, :, slice_idx].T, cmap='gray', alpha=0.5, origin='lower')
    axes[2].set_title("nnU-Net Prediction")
    axes[2].axis('off')

    # plt.tight_layout()
    plt.savefig("./prediction_comparison_noise_.png", dpi=300)
    plt.show()

# Example usage:
visualize_prediction('/home/temi/Downloads/img.nii.gz', "/home/temi/Downloads/label.nii.gz", '/home/temi/Downloads/pred.nii.gz')